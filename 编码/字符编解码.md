
## 带着问题
1. 什么是字符集，什么是字符编码，两者的区别及关联？
   >顾名思义，字符集就是多个字符的集合，是一个系统支持的所有抽象字符的集合。字符是各种文字和符号的总称，包括各国家文字、标点符号、图形符号、数字等，如GB2312、unicode等。
   
   >字符编码是一套规则，它将一种字符集当中的编号索引映射为计算机能够处理的二进制信息。计算机由编码后的二进制信息根据编码规则得到字符的索引，然后对着相应的字符集就能将其还原成人们所能理解的字符信息（如文字或者表情）。编码后的数据更方便在计算机中存储或和网络之间传输。常见的编码方式如utf-8等。

   >在unicode普及以前，早期的编码如ASCII、GB2312、Big5、GBK、GB18030等，不仅代表字符集，同时也代表了其对应的编码方式。比如 ASCII 既是字符集又是编码方案，GB2312 用的则是 EUC-CN 编码方案；而unicode就只单纯地代表字符集，编码方式则有多种，如utf-8、utf-16等。

2. [Unicode](https://zh.wikipedia.org/wiki/Unicode)
   >官方中文名称为统一码，也译名为万国码、国际码、单一码，是计算机科学领域的业界标准。它整理、编码了世界上大部分的文字系统，使得电脑可以用更为简单的方式来呈现和处理文字。Unicode的发展由非营利机构统一码联盟负责，并伴随着通用字符集的标准而发展。Unicode大约在2000年左右才得到计算机系统的广泛支持，因而可以解释为什么会有其他那么多的编码方式(ASCII、GB2312等)存在。
3. [通用字符集（UCS）](https://zh.wikipedia.org/wiki/%E9%80%9A%E7%94%A8%E5%AD%97%E7%AC%A6%E9%9B%86)
   >是由ISO制定的ISO 10646（或称ISO/IEC 10646）标准所定义的标准字符集。

4. [GB 13000](http://openstd.samr.gov.cn/bzgk/gb/std_list?p.p1=0&p.p90=circulation_date&p.p91=desc&p.p2=13000): 
   >字符集，UCS的等同采用，可以理解为把国际标准拿来作为国家标准，东西还是那么个东西，但是更新没有UCS那么频繁，迄今只有两个版本。
5. Unicode与UCS的关系
   >Unicode与UCS是由两个不同组织创建和维护，但是互相兼容，可以认为两者是等同的。
6. 码元（Code Unit）
   >是指一个已编码的文本中具有最短的比特组合的单元。对于UTF-8来说，码元是8比特长；对于UTF-16来说，码元是16比特长；对于UTF-32来说，码元是32比特长。
7. utf-8、utf-16、utf-32又是什么、它们与unicode的关系，以及各自之间的区别
   >utf-8、utf-16、utf-32都属于字符编码方式，对应的字符集就是Unicode。utf-16、utf-32都有大端(BE)、小端(LE)两种编码方式。utf-8，采用变长多字节编码，用1-4个字节进行编码；utf-16采用两个或者四个字节进行编码；utf-32采用4个字节进行编码。用的最多的编码方式当属utf-8，因为其最节省空间。
8. utf-8与常见的GB18030之间的区别
   >两者都采用变长多字节进行编码，但是utf-8对汉字通常采用三个字节进行编码，而GB18030大都使用两个字节，也就是说对于中文，采用GB18030编码占用的空间通常更小。
9. GB2312、GBK、GB18030、GB13000之间又是什么关系？
    >GB2312、GBK、GB18030通常意义上代表一种编码方式，不过也可以代表其对应的字符集；GB13000则只代表一种字符集。然而GBK、GB18030又都收录GB13000(GB 13000.1-93)中所有的字符。
    GB2312、GBK、GB18030三种编码方式都是向后兼容的，既后一种编码对应的字符集包含前一种的，相同字符对应的编码也是相同的。比如：

   |  汉字   | GB2312  | GBK | GB18030 | Unicode|
   |  ----  | ----  | ----  | ----  | ----  |
   | 七  | C6DF | C6DF | C6DF | 4E03 |
   | 八  | B0CB | B0CB | B0CB | 516B |

## 重点来了

### unicode
Unicode使用16位比特
### utf-8的编码规则

### utf-16的编码规则
在utf-16中，16位比特为一个码元，utf-16用一个码元表示基本平面的字符，用两个码元表示辅助平面的字符。基本平面的字符在utf-16中的编码与其在Unicode中的码位相同。比如字母A的Unicode码位为U+0041，其UTF-16的编码为0041(BE)。那么问题来了，如何确定两个连续的码元代表的是一个辅助平面的字符还是两个基本平面的字符？

在基本平面内，从U+D800到U+DFFF之间的码位区段是永久保留不映射到Unicode字符。也就是说这个区间的编码不代表任何字符。UTF-16就利用保留下来的0xD800-0xDFFF区块的码位来对辅助平面的字符的码位进行编码。换句话说就是，一个码元的值如果位于0xD800-0xDFFF之间，则表明这是一个辅助平面字符的一部分，需要跟前面或者后面的一个码元组合起来才能代表一个字符。

UTF-16又将U+D800-U+DFFF之间的区域一分为二，其中小的U+D800-U+DBFF为UTF-16的高半区(亦称前导代理、高位代理)，大的DC00-DFFF	为UTF-16的低半区(亦称后尾代理、低位代理)，每个半区都有1024个码点，这样高位低位的组合一共就有1024x1024=1048576种了，足以覆盖辅助平面的所有字符了。<font color="red">换句话说，辅助平面字符的两个码元，每个码元虽然只有1024个码点，但是两个码元组合起来就有1048576种了。</font>

除此之外，由于前导代理、后尾代理、基本平面中的有效字符的码位，三者互不重叠，搜索是简单的：一个字符编码的一部分不可能与另一个字符编码的不同部分相重叠（通过文本中的任意一个码元就可以判定它代表的是一个基本平面字符还是辅助平面的前导代理或者后尾代理）。这意味着UTF-16是自同步（self-synchronizing）的：可以通过仅检查一个码元来判定给定字符的下一个字符的起始码元。


### 不同编码之间的转换



1. 如何通过编码转换成对应的字符以及如何获取一个字符的`unicode`编码

- 由字符获取对应的unicode编码：`String.prototype.codePointAt()`，它返回一个unicode编码点值得非负整数。

- 从unicode字符编码获取对应的字符：`String.fromCodePoint()`，它是一个静态方法，返回使用指定的代码点序列创建的字符串。

>上述两个方法为ES6新增，可以支持转换完整的unicode字符，而`String.fromCharCode()`、`String.prototype.charCodeAt()`只支持转换BMP(基本多文种平面，范围0~65535)的字符，超出则无法转换。ps：`codePointAt`与`fromCodePoint`可以分别通过`charCodeAt`和`fromCharCode`进行polyfill。



https://www.zhihu.com/question/21887246/answer/19631235